#!/usr/bin/env bash

if [ -f "`pwd`/DOTFILE" ]; then
  echo "DOTFILE exits"
  source "`pwd`/DOTFILE"
  echo $DOTFILESPATH
else
  echo "DOTFILE not exits"
  echo "exec: rake install"
  exit
fi

if [ -n "${DOTFILESPATH+x}" ]; then
  export DOTFILE=$DOTFILESPATH
else
  echo "DOTFILESPATH not exits"
  exit
fi
echo "DOTFILES Path: ${DOTFILE}"
echo "HOME Path: ${HOME}"

mv $HOME/.bashrc $HOME/.bashrc.bak
rm $HOME/.bashrc
mv $HOME/.bash_profile $HOME/.bash_profile.bak
rm $HOME/.bash_profile
mv $HOME/.gitconfig $HOME/.gitconfig.bak
mv $HOME/.rubocop.yml $HOME/.rubocop.yml.bak

ln -nfsv "$DOTFILE/DOTFILE" $HOME/.DOTFILE
ln -nfsv "$DOTFILE/bashrc" $HOME/.bash_profile
ln -nfsv "$DOTFILE/bashrc" $HOME/.bashrc
ln -nfsv "$DOTFILE/gitconfig" $HOME/.gitconfig
ln -nfsv "$DOTFILE/rubocop.yml" $HOME/.rubocop.yml

#ruby-rails
mv $HOME/.irbrc $HOME/.irbrc.bak
mv $HOME/.railsconsolerc $HOME/.railsconsolerc.bak
mv $HOME/.railsrc $HOME/.railsrc.bak
mv $HOME/.autotest $HOME/.railsrc.bak
mv $HOME/.rdebugrc  $HOME/.rdebugrc.bak
mv $HOME/.tmux.conf  $HOME/.tmux_conf.bak

ln -nfsv "$DOTFILE/irbrc" $HOME/.irbrc
ln -nfsv "$DOTFILE/railsrc" $HOME/.railsrc
ln -nfsv "$DOTFILE/railsconsolerc" $HOME/.railsconsolerc
ln -nfsv "$DOTFILE/autotest" $HOME/.autotest
ln -nfsv "$DOTFILE/rdebugrc" $HOME/.rdebugrc
ln -nfsv "$DOTFILE/tmuxconf" $HOME/.tmux.conf

#Install vim
mv $HOME/.vimrc $HOME/.vimrc.bak
mv $HOME/.gvimrc $HOME/.gvimrc.bak

ln -nfsv "$DOTFILE/vim/vimrc" $HOME/.vimrc
ln -nfsv "$DOTFILE/vim/gvimrc" $HOME/.gvimrc
ln -nfsv "$DOTFILE/vim/dot_vim" $HOME/.vim

echo "fertig set_links"
